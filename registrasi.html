<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pendaftaran UMKM - Jelajah Rasa Surabaya</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Poppins',sans-serif;background:#f8f9fa;color:#333;display:flex;flex-direction:column;min-height:100vh}
    .navbar{display:flex;justify-content:space-between;align-items:center;padding:1rem 5%;background:#fff;box-shadow:0 2px 4px rgba(0,0,0,.1);position:sticky;top:0;z-index:1000}
    .navbar-logo{font-size:1.25rem;font-weight:700;color:#d32f2f;display:flex;align-items:center;text-decoration:none}
    .navbar-logo img{height:50px;margin-right:10px}
    .navbar-nav a{color:#333;text-decoration:none;margin-left:1.25rem;font-weight:600}
    .registrasi-page-main{padding:4rem 2rem;flex-grow:1;display:flex;align-items:center;justify-content:center;background-image:linear-gradient(rgba(0,0,0,.3),rgba(0,0,0,.3)),url('https://images.unsplash.com/photo-1555396273-367ea4eb4db5?q=80&w=1974&auto=format&fit=crop');background-size:cover;background-position:center}
    .form-container{background:#fff;padding:2.5rem;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:100%;max-width:640px}
    .form-title{text-align:center;font-size:1.8rem;font-weight:700;margin-bottom:2rem}
    .form-group{margin-bottom:1rem}
    .form-group label{display:block;margin-bottom:.45rem;font-weight:600;color:#555}
    .form-group input[type="text"], .form-group input[type="url"], .form-group textarea, .form-group select{width:100%;padding:.8rem 1rem;border:none;background:#ececec;border-radius:10px;font-size:1rem}
    .form-group textarea{min-height:120px;resize:vertical}
    .form-group input[type="file"]{font-size:.9rem;color:#555}
    .submit-button{padding:.8rem 1.5rem;border:none;background:#5a5a5a;color:#fff;font-weight:600;font-size:1rem;border-radius:10px;cursor:pointer;transition:background .25s ease;display:block;margin:1.2rem auto 0}
    .submit-button.valid{background:#2e7d32}
    .submit-button:hover{filter:brightness(.95)}
    .footer{background:#212121;color:#fff;text-align:center;padding:1.25rem 5%}
    @media(max-width:768px){.navbar-nav{display:none}.form-container{padding:1.5rem}.form-title{font-size:1.5rem}}
  </style>
</head>
<body>
  <header>
    <nav class="navbar">
      <a href="index.html" class="navbar-logo"><img src="image/logo.png" alt="Logo"> Jelajah Rasa Surabaya</a>
      <div class="navbar-nav">
        <a href="index.html">Home</a>
        <a href="index.html#rekomendasi">UMKM</a>
        <a href="registrasi.html" style="color:#d32f2f">Registrasi UMKM</a>
      </div>
    </nav>
  </header>

  <main class="registrasi-page-main">
    <div class="form-container" id="form-container">
      <h1 class="form-title">Pendaftaran UMKM</h1>

      <form id="umkmForm" method="POST" enctype="multipart/form-data" novalidate>
        <div class="form-group">
          <label for="nama-usaha">Nama Usaha:</label>
          <input type="text" id="nama-usaha" required>
        </div>

        <div class="form-group">
          <label for="upload-foto">Upload Foto (bisa lebih dari 1):</label>
          <input type="file" id="upload-foto" accept="image/*" multiple required>
        </div>

        <div class="form-group">
          <label for="kategori">Kategori:</label>
          <select id="kategori" required>
            <option value="">Pilih kategori</option>
            <option value="Halal">Halal</option>
            <option value="Non-Halal">Non-Halal</option>
          </select>
        </div>

        <div class="form-group">
          <label for="area">Area Lokasi:</label>
          <select id="area" required>
            <option value="">Pilih area</option>
            <option value="Pusat">Surabaya Pusat</option>
            <option value="Timur">Surabaya Timur</option>
            <option value="Barat">Surabaya Barat</option>
            <option value="Utara">Surabaya Utara</option>
            <option value="Selatan">Surabaya Selatan</option>
          </select>
        </div>

        <div class="form-group">
          <label for="about-usaha">About (Deskripsi Usaha):</label>
          <textarea id="about-usaha" required placeholder="Minimal 15 kata"></textarea>
        </div>

        <div class="form-group">
          <label for="pricelist-usaha">Pricelist (Contoh: Nasi Rawon - 10000, Rawon Special - 15000):</label>
          <textarea id="pricelist-usaha" required placeholder="Pisahkan item dengan koma (,) atau baris baru"></textarea>
        </div>

        <div class="form-group">
          <label for="kontak-usaha">Kontak (No. WA/Telepon):</label>
          <input type="text" id="kontak-usaha" placeholder="08123456789" required>
        </div>

        <div class="form-group">
          <label for="gmaps-link">Link Google Maps:</label>
          <input type="url" id="gmaps-link" placeholder="https://maps.app.goo.gl/..." required>
        </div>

        <button type="submit" class="submit-button" id="btnSubmit">Kirim Pendaftaran</button>
      </form>
    </div>
  </main>

  <footer class="footer">
    <p>© 2025 | Jelajah Rasa Surabaya — Kelompok 4 Beginner.</p>
  </footer>

  <script>
    const LS_KEY='dataUMKM';
    const form = document.getElementById('umkmForm');
    const btn = document.getElementById('btnSubmit');

    const readAsDataURL = (file)=> new Promise((res,rej)=>{
      const r=new FileReader(); r.onload=()=>res(r.result); r.onerror=()=>rej(new Error('Gagal membaca file')); r.readAsDataURL(file);
    });

    // Tombol jadi hijau ketika form valid
    function checkValidity(){
      const valid = form.checkValidity() && (document.getElementById('about-usaha').value.trim().split(/\s+/).length>=15);
      btn.classList.toggle('valid', valid);
    }
    form.addEventListener('input', checkValidity);
    form.addEventListener('change', checkValidity);
    document.addEventListener('DOMContentLoaded', checkValidity);

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      checkValidity();
      if(!btn.classList.contains('valid')){
        alert('Lengkapi semua kolom sesuai aturan (deskripsi ≥ 15 kata).');
        return;
      }

      const files = Array.from(document.getElementById('upload-foto').files||[]);
      if(!files.length){ alert('Harap upload minimal satu foto usaha!'); return; }
      const thumbs = await Promise.all(files.map(readAsDataURL));

      const data = JSON.parse(localStorage.getItem(LS_KEY)||'[]');
      data.push({
        nama: document.getElementById('nama-usaha').value.trim(),
        deskripsi: document.getElementById('about-usaha').value.trim(),
        foto: thumbs[0],
        thumbnails: thumbs,
        pricelistData: document.getElementById('pricelist-usaha').value.trim(),
        kontakData: document.getElementById('kontak-usaha').value.trim(),
        gmapsData: document.getElementById('gmaps-link').value.trim(),
        status: "Menunggu verifikasi admin",
        kategori: document.getElementById('kategori').value,
        area: document.getElementById('area').value
      });
      localStorage.setItem(LS_KEY, JSON.stringify(data));

      document.getElementById('form-container').innerHTML = `
        <h1 class="form-title">Pendaftaran UMKM</h1>
        <div style="text-align:center">
          <h3 style="color:#2e7d32">Pendaftaran telah diterima.</h3>
          <p>Menunggu verifikasi admin untuk ditampilkan di halaman utama.</p>
          <a href="index.html" style="display:inline-block;margin-top:1rem;padding:.6rem 1rem;background:#5a5a5a;color:#fff;text-decoration:none;border-radius:8px">Kembali ke Halaman Utama</a>
        </div>
      `;
      window.scrollTo({top:0,behavior:'smooth'});
    });
  </script>
</body>
</html>
